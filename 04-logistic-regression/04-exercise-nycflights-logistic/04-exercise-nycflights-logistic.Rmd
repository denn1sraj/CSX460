---
title: "NYCFlights: Arrival Delay Logictic Model"
author: "Dennis Raj"
date: "April 26, 2017"
output: html_document
---

```{r Step 1: Import Data and Setup Libraries, include=FALSE }
knitr::opts_chunk$set(echo = TRUE)
#load libraries
library(dplyr)
library(magrittr)
library(readr)
library(ggplot2)


# make sure flights_final.csv is in the current working directory, if not use Rstudio or setwd() 
# set the working directory to read in the csv
flights <- tbl_df(read_csv("flights_final.csv", col_names = TRUE))
```

```{r Step 2: Data Cleaning}

# from the assignment -- predict delays >= 22 minutes

# Filter the data to remove na's and limit the data to arrival delays greater than or equal to 22 minutes 
flights$cat_delay <- "normal"
flights$cat_delay[flights$arr_delay >= 22] <- "late"
flights$cat_delay <- factor(flights$cat_delay)

flights %>% select(cat_delay, arr_delay) %>% group_by(cat_delay) %>% summarize(count = n())

#create the y values for our predicted variable??? 

                      
```

```{r Step 3: Initial Investigation}

fit1 <- 

fit_start <- glm(formula = cat_delay ~ carrier + distance + origin, data = flights, family = "binomial")
summary(fit_start)
```

## Logsitic and Inverse Logistic Transformation 

- Write an R function for the logistic function. The function should accept a `numeric` vector with values `[-Inf,Inf]` and produce a numeric vector in the the range `[0,1]`.

- Plot the logistic function from  `[-10,10]`

- Write a R function for the inverse logistic function. The function should accept a `numeric` vector with values `[0,1]` and prodcuce a numeric vector in the range `[-Inf,Inf]`

- Plot the Inverse Logistic function from `[0,1]`


**Hint:** For plotting curves see `?graphics::curve` or `?ggplot2::stat_function`

```{r "Logistic and Inverse Logistic" }

```


# NYCFlights Model

Using the rectangular data that you created from the earlier assignment and following theexample from the text and class, create a model for arr_delay >= 22 minutes. Describe/Explain each of the steps and show all work.

KNIT YOUR DOCUMENT AS *HTML* AND SUBMIT IT AND THE `Rmd` file to your repository.   


# Question:

Is this a good model?  (Write your answer here.)


# PART B:

Your model should be good at explaining tardiness. Now, assume that your job is to predict arrival delays a month in advance. You can no longer use all the features in your model. Retrain your model using only features that will be *known* only a month in advance of the departure time.  Show all steps as above.

